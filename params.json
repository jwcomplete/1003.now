{"name":"1003.now","tagline":"take a 1003","body":"customElements.define('x-frame-bypass', class extends HTMLIFrameElement {\r\n\tconstructor () {\r\n\t\tsuper()\r\n\t}\r\n\tconnectedCallback () {\r\n\t\tthis.load(this.src)\r\n\t\tthis.src = ''\r\n\t\tthis.sandbox = '' + this.sandbox || 'allow-forms allow-modals allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts allow-top-navigation-by-user-activation' // all except allow-top-navigation\r\n\t}\r\n\tload (url, options) {\r\n\t\tif (!url || !url.startsWith('http'))\r\n\t\t\tthrow new Error(`X-Frame-Bypass src ${url} does not start with http(s)://`)\r\n\t\tconsole.log('X-Frame-Bypass loading:', url)\r\n\t\tthis.srcdoc = `<html>\r\n<head>\r\n\t<style>\r\n\t.loader {\r\n\t\tposition: absolute;\r\n\t\ttop: calc(50% - 25px);\r\n\t\tleft: calc(50% - 25px);\r\n\t\twidth: 50px;\r\n\t\theight: 50px;\r\n\t\tbackground-color: #333;\r\n\t\tborder-radius: 50%;  \r\n\t\tanimation: loader 1s infinite ease-in-out;\r\n\t}\r\n\t@keyframes loader {\r\n\t\t0% {\r\n\t\ttransform: scale(0);\r\n\t\t}\r\n\t\t100% {\r\n\t\ttransform: scale(1);\r\n\t\topacity: 0;\r\n\t\t}\r\n\t}\r\n\t</style>\r\n</head>\r\n<body>\r\n\t<div class=\"loader\"></div>\r\n</body>\r\n</html>`\r\n\t\tthis.fetchProxy(url, options, 0).then(res => res.text()).then(data => {\r\n\t\t\tif (data)\r\n\t\t\t\tthis.srcdoc = data.replace(/<head([^>]*)>/i, `<head$1>\r\n\t<base href=\"${url}\">\r\n\t<script>\r\n\t// X-Frame-Bypass navigation event handlers\r\n\tdocument.addEventListener('click', e => {\r\n\t\tif (frameElement && document.activeElement && document.activeElement.href) {\r\n\t\t\te.preventDefault()\r\n\t\t\tframeElement.load(document.activeElement.href)\r\n\t\t}\r\n\t})\r\n\tdocument.addEventListener('submit', e => {\r\n\t\tif (frameElement && document.activeElement && document.activeElement.form && document.activeElement.form.action) {\r\n\t\t\te.preventDefault()\r\n\t\t\tif (document.activeElement.form.method === 'post')\r\n\t\t\t\tframeElement.load(document.activeElement.form.action, {method: 'post', body: new FormData(document.activeElement.form)})\r\n\t\t\telse\r\n\t\t\t\tframeElement.load(document.activeElement.form.action + '?' + new URLSearchParams(new FormData(document.activeElement.form)))\r\n\t\t}\r\n\t})\r\n\t</script>`)\r\n\t\t}).catch(e => console.error('Cannot load X-Frame-Bypass:', e))\r\n\t}\r\n\tfetchProxy (url, options, i) {\r\n\t\tconst proxy = [\r\n\t\t\t'https://cors.io/?',\r\n\t\t\t'https://jsonp.afeld.me/?url=',\r\n\t\t\t'https://cors-anywhere.herokuapp.com/'\r\n\t\t]\r\n\t\treturn fetch(proxy[i] + url, options).then(res => {\r\n\t\t\tif (!res.ok)\r\n\t\t\t\tthrow new Error(`${res.status} ${res.statusText}`);\r\n\t\t\treturn res\r\n\t\t}).catch(error => {\r\n\t\t\tif (i === proxy.length - 1)\r\n\t\t\t\tthrow error\r\n\t\t\treturn this.fetchProxy(url, options, i + 1)\r\n\t\t})\r\n\t}\r\n}, {extends: 'iframe'})","note":"Don't delete this file! It's used internally to help with page regeneration."}